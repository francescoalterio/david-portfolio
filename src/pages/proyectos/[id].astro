---
import Layout from "../../layouts/Layout.astro";
import projects from "../../data/projects.json";

export async function getStaticPaths() {
  return projects.map((project) => ({ params: { id: project.id } }));
}

const { id } = Astro.params;
let project = projects.find((p) => p.id === id);

if (!project) {
  project = {
    id: "not-found",
    title: "Proyecto no encontrado",
    image: "/assets/prueba.webp",
    description: "No hay descripción disponible.",
    details: "El proyecto solicitado no existe o fue eliminado.",
  };
}
---

<Layout>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap"
    rel="stylesheet"
  />
  <section
    class="project-box"
    style="max-width:700px; margin:2rem auto; border-radius:18px; box-shadow:0 4px 24px #0001; padding:2.5rem 2rem; text-align:center; font-family:'Poppins', Arial, Helvetica, sans-serif;"
  >
    <h1 class="project-title">
      {project.title}
    </h1>
    <img
      src={project.image}
      alt={project.title}
      style="width:100%; max-width:700px; border-radius:22px; margin:2.5rem auto; box-shadow:0 6px 32px #0004; display:block;"
      viewTransitionName={`project-image-${project.id}`}
    />
    <h2
      class="project-desc-title"
      style="margin-top:2.5rem; font-size:2rem; font-weight:700; letter-spacing:0.01em;"
    >
      Descripción
    </h2>
    <p class="project-details">
      {project.details}
    </p>
    {
      project.images && project.images.length > 0 && (
        <div style="margin:2rem 0; display:flex; flex-direction:column; gap:1.5rem; align-items:center;">
          {project.images.map((img, idx) => (
            <img
              src={img}
              alt={`Imagen extra ${idx + 1}`}
              style="width:100%; max-width:500px; border-radius:12px; box-shadow:0 2px 12px #0002; object-fit:cover;"
            />
          ))}
        </div>
      )
    }
    <a href="/proyectos" class="project-back">← Volver a proyectos</a>
  </section>
</Layout>

<style>
  .project-box {
    background: var(--card-bg, #faf9f6);
    color: var(--card-text, #222);
    font-family: "Poppins", Arial, Helvetica, sans-serif;
    transition:
      background 0.2s,
      color 0.2s;
  }
  .project-title {
    font-size: 2.7rem;
    font-weight: 700;
    margin-bottom: 0.7rem;
    color: var(--card-text, #222);
    font-family: "Poppins", Arial, Helvetica, sans-serif;
    transition: color 0.2s;
  }
  .project-desc-title {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
    color: var(--card-text, #222);
    font-family: "Poppins", Arial, Helvetica, sans-serif;
    transition: color 0.2s;
  }
  .project-details,
  .project-back {
    .darkmode .project-title,
    .darkmode .project-desc-title {
      color: #fff !important;
    }
    color: var(--card-text, #222);
    font-family: "Poppins", Arial, Helvetica, sans-serif;
    transition: color 0.2s;
  }
  .darkmode .project-box {
    background: var(--card-bg, #232427);
    color: var(--card-text, #fff);
  }
  .darkmode .project-title,
  .darkmode .project-details,
  .darkmode .project-back {
    color: #fff !important;
  }
</style>
